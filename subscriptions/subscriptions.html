<meta name="owner" content="GihanHerath">
<meta name="modifiedBy" content="Kasun">
<meta name="modifiedDate" content="15-02-2017">
<meta name="version" content="6.0.1.0">
<meta name="app" content="plans">
<meta name="view" content="plans.html">

<div id="subscriptions" class="page-layout carded left-sidenav" layout="row" ng-switch="vm.appInnerState">

    <!-- TOP BACKGROUND -->
    <div class="top-bg md-accent-bg"></div>
    <!-- / TOP BACKGROUND -->

    <!-- CENTER -->
    <div ng-switch-when="default" class="center" layout="column" flex>
        <!-- CONTENT HEADER- V NAV-->
        <div layout="column" layout-align="start start">
            <div class="v-header" layout="column" flex fill-width>
                <div class="title" layout="column" layout-align="center start" ng-if="!themeDuoworld">
                    <div class="logo" layout="row" layout-align="start center">
                        <span class="logo-icon">
                          <img src="app/core/app_icons/subscriptions_app_icon.png" alt=""/>
                        </span>
                        <span class="logo-text">Subscriptions</span>
                    </div>
                </div>
                <div layout="row">
                    <div class="title" layout="column" layout-align="center start" ng-if="themeDuoworld">
                        <div class="logo" layout="row" layout-align="start center">
                            <span class="logo-icon">
                              <img src="app/core/app_icons/subscriptions_app_icon_black.png" alt=""/>
                            </span>
                            <span class="logo-text">Subscriptions</span>
                        </div>
                    </div>
                    <div class="search-wrapper" layout="row" layout-align="start center" flex>
                        <md-button class="md-icon-button sidenav-toggle" ng-click="vm.toggleSidenav('main-sidenav')" hide-gt-md aria-label="Toggle Sidenav">
                            <md-icon class="icon" md-font-icon="icon-menu"></md-icon>
                        </md-button>

                        <div class="search" flex layout="row" layout-align="start center">
                            <md-icon md-font-icon="icon-magnify" class="icon s24"></md-icon>
                            <input flex ng-model="vm.search" type="text" ng-keypress="searchKeyPress($event,vm.search,vm.search.length)" ng-change="loadByKeywordSubscription(vm.search,3)" placeholder="Search for subscriptions *eg: someone@example.com">
                        </div>
                    </div>
                    <md-button class="md-raised md-accent main-app-create" layout="row" layout-align="center center" aria-label="compose" ng-disabled="vm.activePlanPaneIndex == 1" ng-click="toggleEdit()" ng-if="!inpageReadPaneEdit"><span class="fs-18 mr-10">+</span> NEW
                        </md-button>
                </div>
            </div>
            <!--<div class="v-nav">-->
            <!--<div ng-include="'app/main/plans/sidenavs/main/main-sidenav.html'"></div>-->
            <!--</div>-->

        </div>
        <!-- / CONTENT HEADER -->

        <!--</div>-->
        <!-- / CONTENT HEADER -->

        <div layout="row" flex>
            <!-- CONTENT CARD -->
            <div class="content-card" layout="column" flex ng-class="{'flex-30':showInpageReadpane}">

                <!-- CONTENT TOOLBAR -->
                <div class="toolbar list-header" layout="row" layout-align="space-between center" ng-if="vm.activePlanPaneIndex === 0">
                    <div ng-include="'app/main/subscriptions/views/list/list-header.html'" layout="row" flex layout-align="start center"></div>
                </div>
                <div class="toolbar pr-0" layout="row" layout-align="end center" ng-if="vm.activePlanPaneIndex === 1">
                    <h3 flex>New subscription</h3>
                    <md-button class="md-icon-button"
                                ng-click="vm.closeReadPane()"
                                aria-label="Back"
                                ng-disabled="nextSheduleUpdating">
                        <md-icon md-font-icon="icon-close"></md-icon>
                    </md-button>
                </div>
                <!-- / CONTENT TOOLBAR -->

                <!-- CONTENT WRAPPER -->
                <div class="content-wrapper" layout="row" flex>
                    <md-tabs md-selected="vm.activePlanPaneIndex" class="content-tabs" md-dynamic-height="{{vm.dynamicHeight}}" flex>
                        <!-- INVOICE LIST PANE -->
                        <md-tab>
                            <md-tab-label>Plans List Pane</md-tab-label>
                            <md-tab-body>
                                <div layout="row">
                                    <div flex class="content main-list-pane"
                                         ng-include="'app/main/subscriptions/views/list/list-view.html'" ms-scroll>
                                    </div>
                                </div>

                            </md-tab-body>
                        </md-tab>
                        <!-- / INVOICE LIST PANE -->

                        <!-- INVOICE DISPLAY PANE -->
                        <md-tab>
                            <md-tab-label>Plans Display Pane</md-tab-label>
                            <md-tab-body>
                                <div class="content plan-display-pane mb-50"
                                     ng-include="'app/main/subscriptions/views/read/read-view.html'" ms-scroll>
                                </div>
                                <div md-whiteframe="8dp" layout="row" layout-align="space-between center" class="bottom-fixed-bar fixed">
                                    <div layout="row"></div>

                                    <div layout="row" class="layout-row">
                                        <md-progress-circular class="gen-save-indicator" ng-if="vm.submitted"></md-progress-circular>
                                        <md-button ng-click="clearform()">Clear</md-button>
                                        <md-button ng-disabled="vm.submitted" type="submit" form="subscriptionForm" class="md-raised md-accent">Save</md-button>
                                    </div>
                                </div>
                            </md-tab-body>
                        </md-tab>
                        <!-- / INVOICE DISPLAY PANE -->
                    </md-tabs>
                </div>
                <!-- / CONTENT WRAPPER -->
            </div>
            <!-- / CONTENT CARD -->
            <div flex="80" class="inpage-readpane" ng-if="showInpageReadpane" md-whiteframe="4dp">
                <div layout="row" layout-align="space-between center" class="inpage-readpane-toolbar">
                    <h3 class="group-sub-head" layout="row" layout-align="start center">Subscription Info</h3>
                    <div layout="row">
                        <md-menu>
                            <md-button aria-label="More" class="md-icon-button" ng-click="$mdOpenMenu($event)">
                                <md-icon md-font-icon="icon-menu"></md-icon>
                                <md-tooltip>Actions</md-tooltip>
                            </md-button>

                            <md-menu-content width="3">
                                <md-menu-item>
                                    <md-button aria-label="Delete" layout="row" layout-align="start center" ng-click="openSubscriptionStopPane($event,vm.selectedSubscription)" ng-disabled="vm.selectedSubscription.orderStatus == 'Stopped' || vm.selectedSubscription.remark=='endofsubscription'">
                                        <i class="material-icons md-warn">not_interested</i>
                                        <span>Deactivate Subscription</span>
                                    </md-button>
                                </md-menu-item>
                                <md-menu-item>
                                    <md-button aria-label="Delete" ng-disabled="vm.selectedSubscription.orderStatus == 'Active'">
                                        <md-icon md-font-icon="icon-play" class="md-accent"></md-icon>
                                        <span>Start</span>
                                    </md-button>
                                </md-menu-item>
                            </md-menu-content>
                        </md-menu>
                        <md-button class="md-icon-button" ng-click="switchInfoPane('close',vm.selectedPlan)">
                            <md-icon md-font-icon="icon-close"></md-icon>
                            <md-tooltip>Close</md-tooltip>
                        </md-button>
                    </div>
                </div>
                <div id="stop-subscription" layout="column" ng-if="stopPaneOpen" class="animate-slide-down" md-whiteframe="4dp">
                    <div class="header-bar text-right" layout="row" layout-align="space-between center">
                        <h3>Deactivate Subscription</h3>
                        <md-button class="md-icon-button" ng-click="closeSubscriptionStopPane()"><md-icon md-font-icon="icon-close"></md-icon> </md-button>
                    </div>
                    <div class="p-20">
                        <div>
                            <div layout="row" layout-align="start center" class="title">
                                <i class="material-icons">not_interested</i> <span flex>Deactivate immediately</span>
                            </div>
                            <div class="mt-10 mb-20">Subscription will be deactivated immediately</div>
                            <div layout="row" layout-align="end center">
                                <md-button class="md-accent md-raised" ng-click="showStopSubscriptionConfirm($event,vm.selectedSubscription,'Immediate')">Choose this</md-button>
                            </div>
                        </div>
                        <md-divider class="mv-20"></md-divider>
                        <div>
                            <div layout="row" layout-align="start center" class="title">
                                <i class="material-icons">not_interested</i> <span flex>Deactivate on renewal</span>
                            </div>
                            <div class="mt-10 mb-20">Subscription will be deactivated on {{vm.selectedSubscription.endDate | limitTo:10}}</div>
                            <div layout="row" layout-align="end center">
                                <md-button class="md-accent md-raised" ng-click="showStopSubscriptionConfirm($event,vm.selectedSubscription,'EOM')">Choose this</md-button>
                            </div>
                        </div>
                    </div>
                </div>
                <md-content flex ms-scroll layout="column" class="inpage-readpane-body p-0">
                    <span class="type-flag" ng-if="vm.selectedSubscription.class == 'Trial'">Trial</span>
                    <div class="main-list-preloader animate-fade-in-out" layout="row" layout-sm="column" layout-align="space-around" ng-hide="isReadLoaded">
                        <md-progress-circular md-mode="indeterminate"></md-progress-circular>
                    </div>
                    <md-tabs md-border-bottom class="inner-iconed-tabs" flex>
                        <md-tab label="Overview">
                            <md-tab-label>
                                <md-icon md-font-icon="icon-cog"></md-icon> General
                            </md-tab-label>
                            <md-tab-body flex>
                                <div class="pt-16 ph-16 pb-50">
                                    <!--Contact Info portion-->
                                    <div layout="row" flex>
                                        <div layout="column" flex>
                                            <div class="pos-rel">
                                                <div layout="row" layout-align="space-between center">
                                                    <div layout="row" layout-align="space-between center" ng-class="{'flex':paymentRetryHistory.paymentFailedDate == null}">
                                                        <div layout="column" layout-align="center start" class="mr-20">
                                                            <div class="fs-20 font-accent fw-400">
                                                                {{vm.selectedSubscription.code}}
                                                                <!--<span class="type-flag" ng-if="vm.selectedSubscription.class == 'Trial'">Trial</span>-->
                                                            </div>
                                                            <div layout="row" class="op-5">
                                                                <span>by <b>{{vm.selectedSubscription.first_name}}</b></span>
                                                            </div>
                                                        </div>
                                                        <div layout="row">
                                                            <span class="pill" layout="row" layout-align="center center" ng-class="{'partial':vm.selectedSubscription.orderStatus==='Pending','negative':vm.selectedSubscription.orderStatus==='Stopped','positive':vm.selectedSubscription.orderStatus==='Active'}">{{vm.selectedSubscription.orderStatus}}</span>
                                                            <span ng-if="vm.selectedSubscription.remark == 'endofsubscription'" class="pill negative w-165 ml-10" layout="row" layout-align="center center">Diactivates on renewal</span>
                                                        </div>
                                                        <div layout="row" layout-align="start center" class="more-collapse" ng-style="showMoreUserInfo ? {'right':'10px','bottom':'0px', 'background':'#fafafa'} : null">
                                                            <md-button class="md-icon-button m-0" ng-click="contentExpandHandler()"><md-icon md-font-icon="icon-chevron-down" ng-if="!showMoreUserInfo"></md-icon><md-icon md-font-icon="icon-chevron-up" ng-if="showMoreUserInfo"></md-icon> </md-button><label ng-if="showMoreUserInfo">Less</label><label ng-if="!showMoreUserInfo">More</label>
                                                        </div>
                                                    </div>
                                                    <!--<div flex>Payment Status:{{paymentRetryHistory.status}}</div>-->
                                                    <div class="retry-state-bar" layout="row" layout-align="start center" ng-if="paymentRetryHistory.paymentFailedDate != null && paymentRetryHistory.status != null" id="moreRetryAnchor">
                                                        <!--<i class="material-icons">repeat</i>-->
                                                        <!--<span class="retry-title">Payment retry status</span>-->
                                                        <div class="retry-status {{paymentRetryHistory.status}}" layout="row" layout-align="start center" ng-click="showPaymentRetryHistry()">
                                                            <img src="assets/icons/retry_black.svg" alt="" ng-if="paymentRetryHistory.firstAttemptStatus != '' || paymentRetryHistory.secondAttemptStatus != '' || paymentRetryHistory.thiredAttemptStatus != ''" ng-hide="paymentRetryHistory.status.toLowerCase() == 'success'">
                                                            <md-icon md-font-icon="icon-check-circle" class="retry-suc" ng-if="paymentRetryHistory.firstAttemptStatus == 'Success' || paymentRetryHistory.secondAttemptStatus == 'Success' || paymentRetryHistory.thiredAttemptStatus == 'Success'"></md-icon>
                                                            <span class="retry-val {{paymentRetryHistory.status}}">
                                                                <label ng-if="paymentRetryHistory.attempted==1 && paymentRetryHistory.status.toLowerCase() != 'success'">1</label>
                                                                <label ng-if="paymentRetryHistory.attempted==2 && paymentRetryHistory.status.toLowerCase() != 'success'">2</label>
                                                                <label ng-if="paymentRetryHistory.attempted==3 && paymentRetryHistory.status.toLowerCase() != 'success'">3</label>
                                                                <label ng-if="paymentRetryHistory.status.toLowerCase() == 'success'"></label>
                                                            </span>
                                                            <span>
                                                                <label ng-if="paymentRetryHistory.attempted==0">PAYMENT FAILED</label>
                                                                <label ng-if="paymentRetryHistory.attempted==1">PAYMENT {{paymentRetryHistory.firstAttemptStatus}}</label>
                                                                <label ng-if="paymentRetryHistory.attempted==2">PAYMENT {{paymentRetryHistory.secondAttemptStatus}}</label>
                                                                <label ng-if="paymentRetryHistory.attempted==3">PAYMENT {{paymentRetryHistory.thiredAttemptStatus}}</label>
                                                                <!--<label ng-if="paymentRetryHistory.status != null && paymentRetryHistory.status != ''">PAYMENT {{paymentRetryHistory.status}}</label>-->
                                                            </span>
                                                        </div>
                                                        <span class="next-retry" ng-if="paymentRetryHistory.nextRetryOn != null && paymentRetryHistory.status.toLowerCase() != 'success'">
                                                            <label>Next retry </label>
                                                            {{paymentRetryHistory.nextRetryOn | limitTo:10}}
                                                        </span>
                                                    </div>
                                                </div>
                                                <md-divider class="mt-10"></md-divider>
                                                <div layout="row" flex ng-if="showMoreUserInfo" class="p-10 light-gray">
                                                    <div layout="column" class="pos-rel" flex>
                                                        <div layout="row">
                                                            <div layout="row" layout-align="start center" class="info-grid-row bordered" flex>
                                                                <div class="iconed-label" layout="row" layout-align="start center" flex>
                                                                    <md-icon md-font-icon="icon-email"></md-icon> <span flex>Email</span>
                                                                </div>
                                                                <div flex>{{vm.selectedSubscription.email_addr}}</div>
                                                            </div>
                                                            <div flex="5"></div>
                                                            <div layout="row" layout-align="start center" class="info-grid-row bordered" flex>
                                                                <div class="iconed-label" layout="row" layout-align="start center" flex>
                                                                    <md-icon md-font-icon="icon-map"></md-icon> <span flex>User category</span>
                                                                </div>
                                                                <div flex class="">{{vm.selectedSubscription.category}}</div>
                                                            </div>
                                                        </div>
                                                        <div layout="row">
                                                            <div layout="row" layout-align="start center" class="info-grid-row bordered" flex>
                                                                <div class="iconed-label" layout="row" layout-align="start center" flex>
                                                                    <md-icon md-font-icon="icon-calendar-check"></md-icon> <span flex>Registered date</span>
                                                                </div>
                                                                <div flex class="">{{vm.selectedSubscription.createdDate.split(' ')[0]}}</div>
                                                            </div>
                                                            <div flex="5"></div>
                                                            <div layout="row" layout-align="start center" class="info-grid-row bordered" flex>
                                                                <div class="iconed-label" layout="row" layout-align="start center" flex>
                                                                    <md-icon md-font-icon="icon-phone"></md-icon> <span flex>Contact</span>
                                                                </div>
                                                                <div flex class="">{{vm.selectedSubscription.contact != '' ? vm.selectedSubscription.contact : '-'}}</div>
                                                            </div>                                                  </div>
                                                        <div layout="row" class="mt-20">
                                                            <div layout="row" layout-align="start center" class="info-grid-row bordered" flex>
                                                                <div class="iconed-label" layout="row" layout-align="start center" flex="25">
                                                                    <md-icon md-font-icon="icon-home"></md-icon> <span flex>Billing address</span>
                                                                </div>
                                                                <div flex class="">{{vm.selectedSubscription.billAddress ? vm.selectedSubscription.billAddress : '-'}}</div>
                                                            </div>
                                                            <div class="info-grid-row bordered" flex="5"></div>
                                                        </div>
                                                        <div layout="row">
                                                            <div layout="row" layout-align="start center" class="info-grid-row bordered" flex>
                                                                <div class="iconed-label" layout="row" layout-align="start center" flex="25">
                                                                    <i class="material-icons">local_shipping</i> <span flex>Shipping address</span>
                                                                </div>
                                                                <div flex class="">{{vm.selectedSubscription.billAddress ? vm.selectedSubscription.billAddress : '-'}}</div>
                                                            </div>
                                                            <div class="info-grid-row" flex="5"></div>
                                                        </div>
                                                        <div layout="row" class="mt-20">
                                                            <div layout="row" layout-align="start center" class="info-grid-row" flex>
                                                                <div class="iconed-label" layout="row" layout-align="start center" flex>
                                                                    <md-icon md-font-icon="icon-credit-card-multiple"></md-icon> <span flex>Cards</span>
                                                                </div>
                                                                <div flex ng-if="vm.selectedSubscription.hasCards != null"><md-icon md-font-icon="icon-credit-card" class="font-accent"></md-icon> Available</div>
                                                                <div flex class="op-5" ng-if="vm.selectedSubscription.hasCards == null"><i>Not available</i></div>
                                                            </div>
                                                            <div flex="5"></div>
                                                            <div layout="row" layout-align="start center" class="info-grid-row" flex>
                                                                <div class="iconed-label" layout="row" layout-align="start center" flex>
                                                                    <i class="material-icons">local_atm</i>
                                                                    <span flex>Payment gateway</span>
                                                                </div>
                                                                <div flex>
                                                                    <!--{{customer_supplier.profile.gatewayType}}-->
                                                                    <div class="online_{{vm.selectedSubscription.gatewayType | lowercase}} scale-down-5" style="margin-left: -40px"></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!--<div layout="row" layout-align="end end" class="more-chevron">-->
                                    <!--<div layout="row" layout-align="start center">-->
                                    <!--<md-button class="md-icon-button m-0" ng-click="contentExpandHandler()"><md-icon md-font-icon="icon-chevron-down" ng-if="!showMoreUserInfo"></md-icon><md-icon md-font-icon="icon-chevron-up" ng-if="showMoreUserInfo"></md-icon> </md-button><label ng-if="showMoreUserInfo">Less</label><label ng-if="!showMoreUserInfo">More</label>-->
                                    <!--</div>-->
                                    <!--</div>-->
                                    <!-- / Contact Info portion-->
                                    <div layout="row" layout-align="space-between center" class="mv-20">
                                        <div class="m-0 labled-numbers big light-blue" flex>
                                            <div>Amount</div>
                                            <div class="pos-rel">
                                                <span class="font-accent-dark">{{vm.selectedSubscription.unitPrice | isoCurrency:BaseCurrency:0}}</span>
                                            </div>
                                        </div>
                                        <div class="m-0 labled-numbers big light-gray" flex>
                                            <div>Period</div>
                                            <div class="pos-rel">
                                                <span>{{vm.selectedSubscription.startDate | date:'yyyy-MM-dd' | limitTo:10}} </span> <span class="op-5 mh-5">to</span> <span> {{vm.selectedSubscription.endDate | date:'yyyy-MM-dd'}}</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div layout="row">
                                        <div flex>
                                            <!--<div layout="row" layout-align="start center" class="info-grid-row">-->
                                            <!--<div class="iconed-label"><span>Type</span></div>-->
                                            <!--<span class="secondary-state-capsule">{{vm.selectedPlan.type}}</span>-->
                                            <!--</div>-->
                                            <!--<div flex layout="row" layout-align="start center" class="info-grid-row bordered-dark">-->
                                            <!--<div flex class="iconed-label">-->
                                            <!--<md-icon md-font-icon="icon-cash"></md-icon> <span>Amount</span>-->
                                            <!--</div>-->
                                            <!--<div flex class="">{{vm.selectedSubscription.unitPrice}}</div>-->
                                            <!--</div>-->
                                            <div flex layout="row" layout-align="start center" class="info-grid-row bordered-dark">
                                                <div flex class="iconed-label">
                                                    <md-icon md-font-icon="icon-map"></md-icon> <span>Plan type</span>
                                                </div>
                                                <div flex class="">{{vm.selectedSubscription.type}}</div>
                                            </div>
                                            <div flex layout="row" layout-align="start center" class="info-grid-row bordered-dark">
                                                <div flex class="iconed-label">
                                                    <md-icon md-font-icon="icon-map"></md-icon> <span>Plan</span>
                                                </div>
                                                <div flex class="">{{vm.selectedSubscription.name}}</div>
                                            </div>
                                            <!--<div flex layout="row" layout-align="start center" class="info-grid-row mb-20">-->
                                            <!--<div flex class="iconed-label">-->
                                            <!--<md-icon md-font-icon="icon-calendar"></md-icon> <span>Period</span>-->
                                            <!--</div>-->
                                            <!--<div flex class=""><span>{{vm.selectedSubscription.startDate|parseDate | date:'dd.mm.yyyy'}} </span>-<span> {{vm.selectedSubscription.endDate|parseDate| date:'dd.mm.yyyy'}}</span></div>-->
                                            <!--</div>-->
                                            <div flex layout="row" layout-align="start center" class="info-grid-row bordered-dark">
                                                <div flex class="iconed-label">
                                                    <md-icon md-font-icon="icon-calendar-check"></md-icon> <span>Last billing date</span>
                                                </div>
                                                <div flex class="">{{vm.selectedSubscription.lastBillDate | parseDate | date: 'dd'}} {{vm.selectedSubscription.lastBillDate | parseDate | date: 'MMMM' | limitTo:3}} {{vm.selectedSubscription.lastBillDate | parseDate | date: 'yyyy'}}</div>
                                            </div>
                                            <div flex layout="row" layout-align="start center" class="info-grid-row">
                                                <div flex class="iconed-label">
                                                    <md-icon md-font-icon="icon-calendar-today"></md-icon>
													<span ng-if="vm.selectedSubscription.remark!='endofsubscription'">Next scheduled date</span>
                                                    <span ng-if="vm.selectedSubscription.remark=='endofsubscription'">Subscription end date</span>
                                                    <md-progress-circular ng-if="nextSheduleUpdating" style="float: right"></md-progress-circular>
                                                </div>
                                                <div flex class="font-accent" ng-if="!scheduledDateEditing" layout="row" layout-align="space-between center">
                                                    {{vm.selectedSubscription.endDate | parseDate | date: 'dd'}} {{vm.selectedSubscription.endDate | parseDate | date: 'MMMM' | limitTo:3}} {{vm.selectedSubscription.endDate | parseDate | date: 'yyyy'}}
                                                    <md-button class="md-accent md-raised h-25 line-height-20" ng-disabled="vm.selectedSubscription.remark=='endofsubscription'" ng-click="editNextScheduledDate()">Change date</md-button>
                                                </div>
                                                <div flex class="font-accent" layout="row" layout-align="start center" ng-if="scheduledDateEditing" md-whiteframe="1dp">
                                                    <md-datepicker ng-model="vm.selectedSubscription.endDate" md-max-date="maxDateAvailable" md-open-on-focus flex></md-datepicker>
                                                    <md-button class="md-primary h-30 line-height-30" ng-click="cancelEditNextScheduledDate()">Cancel</md-button>
                                                    <md-button class="md-accent md-raised w-50 h-30 line-height-30" ng-click="saveNextScheduledDate(vm.selectedSubscription)">Save</md-button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <md-card flex class="input-block-gen sub-list m-0 mt-20" ng-if="addonPlansList.length!=0">
                                        <md-card-title>
                                            <div layout="row" layout-align="start center">
                                                <i class="material-icons">extension</i> <h3>Add-on plans</h3>
                                            </div>
                                        </md-card-title>
                                        <div class="list-header" layout="row">
                                            <div flex>Plan</div>
                                            <div flex>Plan type</div>
                                            <div flex>Quantity</div>
                                            <div flex class="text-right">Amount</div>
                                        </div>
                                        <md-card-content class="p-0" flex>
                                            <md-content class="list-content" ms-scroll>
                                                <div layout="row" layout-align="center center" class="msg-empty-list" ng-if="addonPlansList.length == 0 || addonPlansList == null">
                                                    <span><md-icon md-font-icon="icon-information-outline"></md-icon> No Add-on Plans for this Plan</span>
                                                </div>
                                                <div layout="row" flex class="list-item" ng-repeat="addon in addonPlansList">
                                                    <div flex>
                                                        <span>{{addon.code}}</span>
                                                    </div>
                                                    <div flex>
                                                        <span>Add-On</span>
                                                    </div>
                                                    <div flex>
                                                        <span>{{addon.qty}}</span>
                                                    </div>
                                                    <!--<div flex>-->
                                                    <!--<span>{{addon.lastBillDate | parseDate | date: 'dd'}} {{addon.lastBillDate | parseDate | date: 'MMMM' | limitTo:3}} {{addon.lastBillDate | parseDate | date: 'yyyy'}}</span>-->
                                                    <!--</div>-->
                                                    <!--<div flex class="text-right font-accent">-->
                                                    <!--<span>{{addon.endDate | parseDate | date: 'dd'}} {{addon.endDate | parseDate | date: 'MMMM' | limitTo:3}} {{addon.endDate | parseDate | date: 'yyyy'}}</span>-->
                                                    <!--</div>-->
                                                    <div flex class="text-right">
                                                        <span>{{addon.amount|isoCurrency:BaseCurrency}}</span>
                                                    </div>
                                                </div>
                                            </md-content>
                                        </md-card-content>
                                    </md-card>
                                    <!--<div layout="row" ng-if="addonPlansList.length!=0">-->
                                    <!--<div flex class="list-offset sub-list" md-whiteframe="1dp">-->
                                    <!--<div class="list-header" layout="row" flex md-whiteframe="1dp">-->
                                    <!--<div flex>Plan</div>-->
                                    <!--<div flex>Plan Type</div>-->
                                    <!--<div flex>Quantity</div>-->
                                    <!--<!--<div flex>Last Billing Date</div>-->
                                    <!--<!--<div flex class="text-right">Next Scheduled Date</div>-->
                                    <!--<div flex class="text-right">Amount</div>-->
                                    <!--</div>-->
                                    <!--<md-card-content class="p-0" flex>-->
                                    <!--<md-content class="list-content" ms-scroll>-->
                                    <!--<div layout="row" layout-align="center center" class="msg-empty-list" ng-if="addonPlansList.length == 0 || addonPlansList == null">-->
                                    <!--<span><md-icon md-font-icon="icon-information-outline"></md-icon> No Add-on Plans for this Plan</span>-->
                                    <!--</div>-->
                                    <!--<div layout="row" flex class="list-item" ng-repeat="addon in addonPlansList">-->
                                    <!--<div flex>-->
                                    <!--<span>{{addon.code}}</span>-->
                                    <!--</div>-->
                                    <!--<div flex>-->
                                    <!--<span>Add-On</span>-->
                                    <!--</div>-->
                                    <!--<div flex>-->
                                    <!--<span>{{addon.qty}}</span>-->
                                    <!--</div>-->
                                    <!--<!--<div flex>-->
                                    <!--<!--<span>{{addon.lastBillDate | parseDate | date: 'dd'}} {{addon.lastBillDate | parseDate | date: 'MMMM' | limitTo:3}} {{addon.lastBillDate | parseDate | date: 'yyyy'}}</span>-->
                                    <!--<!--</div>-->
                                    <!--<!--<div flex class="text-right font-accent">-->
                                    <!--<!--<span>{{addon.endDate | parseDate | date: 'dd'}} {{addon.endDate | parseDate | date: 'MMMM' | limitTo:3}} {{addon.endDate | parseDate | date: 'yyyy'}}</span>-->
                                    <!--<!--</div>-->
                                    <!--<div flex class="text-right">-->
                                    <!--<span>{{addon.amount|isoCurrency:BaseCurrency}}</span>-->
                                    <!--</div>-->
                                    <!--</div>-->
                                    <!--</md-content>-->
                                    <!--</md-card-content>-->
                                    <!--</div>-->
                                    <!--</div>-->
                                    <md-card flex class="input-block-gen m-0 mt-30" ng-if="paymentRetryHistoryView">
                                        <md-card-title>
                                            <div layout="row" layout-align="start center">
                                                <md-icon md-font-icon="icon-credit-card-multiple"></md-icon> <h3>Payment retry history</h3>
                                            </div>
                                        </md-card-title>
                                        <md-card-content class="p-0 pb-40" flex>
                                            <div>
                                                <div flex>
                                                    <div layout="row">
                                                        <div flex layout="row" layout-align="start center" class="info-grid-row bordered-dark">
                                                            <div flex class="iconed-label">
                                                                <md-icon md-font-icon="icon-cash"></md-icon> <span>Amount</span>
                                                            </div>
                                                            <div flex class="font-accent">{{paymentRetryHistory.amount|isoCurrency:paymentRetryHistory.currency}}</div>
                                                        </div>
                                                        <div flex="5"></div>
                                                        <div flex layout="row" layout-align="start center" class="info-grid-row bordered-dark">
                                                            <div flex class="iconed-label">
                                                                <md-icon md-font-icon="icon-calendar-remove"></md-icon> <span>Payment failed date</span>
                                                            </div>
                                                            <div flex class="font-accent">{{paymentRetryHistory.paymentFailedDate}}</div>
                                                        </div>
                                                    </div>

                                                    <div class="process-block pt-30">
                                                        <div layout="row" flex>
                                                            <div layout="row" layout-align="start center" class="step-circle" flex="20">
                                                                <span class="circle">1<sup>st</sup></span>
                                                                <span class="label">Retry</span>
                                                            </div>
                                                            <!--<div flex="10" layout="row" layout-align="center center">-->
                                                            <!--<!--<div class="bb flex"></div>-->
                                                            <!--</div>-->
                                                            <div class="step-body" layout="row" layout-align="start center" flex ng-if="paymentRetryHistory.status != ''">
                                                                <div layout="row" layout-align="start center" flex>
                                                                    <div layout="column" flex>
                                                                        <span ng-if="paymentRetryHistory.attempted == 1">Retried on </span>
                                                                        <span><b>{{paymentRetryHistory.paymentFirstDate}}</b></span>
                                                                    </div>
                                                                    <div layout="column" flex>
                                                                        <span>Status </span>
                                                                        <span><b>{{paymentRetryHistory.firstAttemptStatus}}</b></span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="process-block">
                                                        <div layout="row" flex>
                                                            <div layout="row" layout-align="start center" class="step-circle" flex="20">
                                                                <span class="circle">2<sup>nd</sup></span>
                                                                <span class="label">Retry</span>
                                                            </div>
                                                            <!--<div flex="10" layout="row" layout-align="center center">-->
                                                            <!--<!--<div class="bb flex"></div>-->
                                                            <!--</div>-->
                                                            <div class="step-body" layout="row" layout-align="start center" flex ng-if="paymentRetryHistory.paymentSecondDate != null">
                                                                <div layout="row" layout-align="start center" flex>
                                                                    <div layout="column" flex>
                                                                        <span ng-if="paymentRetryHistory.attempted == 2">Retried on </span>
                                                                        <span><b>{{paymentRetryHistory.paymentSecondDate}}</b></span>
                                                                    </div>
                                                                    <div layout="column" flex>
                                                                        <span>Status </span>
                                                                        <span><b>{{paymentRetryHistory.secondAttemptStatus}}</b></span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="process-block">
                                                        <div layout="row" flex>
                                                            <div layout="row" layout-align="start center" class="step-circle" flex="20">
                                                                <span class="circle">3<sup>rd</sup></span>
                                                                <span class="label">Retry</span>
                                                            </div>
                                                            <!--<div flex="10" layout="row" layout-align="center center">-->
                                                            <!--<!--<div class="bb flex"></div>-->
                                                            <!--</div>-->
                                                            <div class="step-body" layout="row" layout-align="start center" flex ng-if="paymentRetryHistory.paymentThiredDate != null">
                                                                <div layout="row" layout-align="start center" flex>
                                                                    <div layout="column" flex>
                                                                        <span ng-if="paymentRetryHistory.attempted == 3">Retried on </span>
                                                                        <span><b>{{paymentRetryHistory.paymentThiredDate}}</b></span>
                                                                    </div>
                                                                    <div layout="column" flex>
                                                                        <span>Status </span>
                                                                        <span><b>{{paymentRetryHistory.thiredAttemptStatus}}</b></span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="process-block pb-0 pt-5">
                                                        <div layout="row" flex>
                                                            <div layout="row" layout-align="start center" class="step-circle mb-0" flex="25">
                                                                    <span class="circle end text-center">
                                                                        <!--<i class="material-icons">report</i>-->
                                                                        END
                                                                    </span>
                                                                <span class="label w-120">Deactivate profile</span>
                                                            </div>
                                                            <div class="step-body" layout="row" layout-align="start center" flex ng-if="paymentRetryHistory.paymentThiredFailedDate != ''">
                                                                <div layout="row" layout-align="start center" flex>
                                                                    <div layout="column" flex>
                                                                        <span class="font-error">Profile has been deactivated</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <md-divider class="mt-20" ng-if="paymentRetryHistory.status.toLowerCase() != 'success'"></md-divider>
                                                    <div layout="row">
                                                        <div flex></div>
                                                        <div flex="5"></div>
                                                        <div flex layout="row" layout-align="start center" class="info-grid-row">
                                                            <div flex class="iconed-label" ng-if="paymentRetryHistory.status.toLowerCase() != 'success' && paymentRetryHistory.attempted != 3">
                                                                <md-icon md-font-icon="icon-calendar-check"></md-icon> <span>Next retry date</span>
                                                            </div>
                                                            <div flex>{{paymentRetryHistory.nextRetryOn}}</div>
                                                        </div>
                                                    </div>

                                                </div>
                                            </div>
                                        </md-card-content>
                                    </md-card>

                                </div>
                            </md-tab-body>
                        </md-tab>
                        <md-tab label="History">
                            <md-tab-label>
                                <md-icon md-font-icon="icon-history"></md-icon> History
                            </md-tab-label>
                            <md-tab-body>
                                <div class="md-padding">
                                    <div flex class="list-offset sub-list">
                                        <div class="list-header" layout="row" flex md-whiteframe="1dp">
                                            <div flex>Plan</div>
                                            <div flex>Start</div>
                                            <div flex>End</div>
                                            <!--<div flex>Occurrences</div>-->
                                            <div flex>Amount</div>
											<div flex>User</div>
                                            <div flex class="text-right">Transaction Date</div>
                                            <div flex class="text-right">Status</div>
                                        </div>
                                        <md-card-content class="p-0" flex>
                                            <md-content class="list-content" ms-scroll>
                                                <div layout="row" layout-align="center center" class="msg-empty-list" ng-if="vm.paymentHistoryList.length == 0 || vm.paymentHistoryList == null">
                                                    <span><md-icon md-font-icon="icon-information-outline"></md-icon> No record has been created yet</span>
                                                </div>
                                                <div layout="row" flex class="list-item" ng-repeat="history in vm.paymentHistoryList" ng-hide="isTenantPaymentHistoryClicked">
                                                    <div flex>
                                                        <span>{{history.code}}</span>
                                                        <div class="fs-12 op-5">{{history.class}}</div>
                                                    </div>
                                                    <div flex>
                                                        <span>{{history.startDate | date:'yyyy.MM.dd'}}</span>
                                                    </div>
                                                    <div flex>
                                                        <span>{{history.endDate | date:'yyyy.MM.dd'}}</span>
                                                    </div>
                                                    <!--<div flex>-->
                                                    <!--<span>{{history.occurences}}</span>-->
                                                    <!--</div>-->
                                                    <div flex>
                                                        <span>{{history.amount|isoCurrency:BaseCurrency}}</span>
                                                    </div>
													<div flex>
                                                      <span>{{history.createdUser}}</span>
                                                    </div>
                                                    <div flex class="text-right">
                                                      <span>{{history.createDate | date:'yyyy.MM.dd'}}</span>
                                                    </div>
                                                    <div flex class="text-right">
                                                        <span>{{history.status}}</span>
                                                    </div>
                                                </div>
                                                <div class="invoice-list-item" ng-if="vm.isOrderHistoryLoaded" layout="row" layout-align="center center">
                                                    <md-button ng-click="searchmoreOrderHistory(vm.selectedSubscription)" class="md-primary fs-12"><md-icon md-font-icon="icon-magnify"></md-icon> More</md-button>
                                                </div>
                                            </md-content>
                                        </md-card-content>
                                    </div>
                                    <!--<md-card class="carded-list-wrap" md-whiteframe="2dp">-->
                                    <!--<md-card-header>-->
                                    <!--<md-card-header-text layout="row">-->
                                    <!--<span flex="10">ID</span>-->
                                    <!--<span flex>CREATED DATE</span>-->
                                    <!--<span flex>MODULE</span>-->
                                    <!--<span flex="35">REMARK</span>-->
                                    <!--</md-card-header-text>-->
                                    <!--</md-card-header>-->
                                    <!--<md-divider></md-divider>-->

                                    <!--<md-content ms-scroll style="height: auto;background-color: #ffffff;max-height: 330px">-->
                                    <!--<div layout="column" layout-align="center center" class="preloader-dot-auto" ng-hide="moreAuditTrailLoaded" >-->
                                    <!--<img src="assets/images/142.gif" alt=""/>-->
                                    <!--</div>-->
                                    <!--<div layout="row" class="carded-list-row" ng-repeat="detail in auditTrailList|orderBy:'-createdDate'" ng-hide="noAuditTrailLabel" style="background-color: #ffffff">-->
                                    <!--<div flex="10">-->
                                    <!--{{$index + 1}}-->
                                    <!--</div>-->
                                    <!--<div flex>-->
                                    <!--{{detail.createdDate | limitTo:10}}-->
                                    <!--</div>-->
                                    <!--<div flex>-->
                                    <!--{{detail.module}}-->
                                    <!--</div>-->
                                    <!--<div flex="35">-->
                                    <!--{{detail.remark}}-->
                                    <!--</div>-->
                                    <!--</div>-->
                                    <!--<div class="invoice-list-item" ng-show="vm.isAuditTrailLoaded" layout="row" layout-align="center center">-->
                                    <!--<md-button ng-click="searchmoreAuditTrails(customer_supplier.profile)" class="md-primary" style="font-size: 12px;font-weight: 400"><md-icon md-font-icon="icon-magnify"></md-icon> More</md-button>-->
                                    <!--</div>-->
                                    <!--<div ng-show="noAuditTrailLabel" layout="column" layout-align="center center" style="height: 100%;">-->
                                    <!--<span class="no-sched"><md-icon md-font-icon="icon-information-outline"></md-icon> No Audit Trails for this User!</span>-->
                                    <!--</div>-->
                                    <!--</md-content>-->
                                    <!--</md-card>-->
                                </div>
                            </md-tab-body>
                        </md-tab>
                    </md-tabs>
                </md-content>
            </div>

            <!--</div>-->
        </div>
    </div>
    <!-- / CENTER -->

</div>
